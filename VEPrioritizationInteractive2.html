<!DOCTYPE html>
<!-- saved from url=(0066)file:///Users/labissy/Downloads/VE_Prioritization_Interactive.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1">
<title>VE Prioritization (Interactive)</title>
<style>
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 24px; color: #222; }
  h1 { font-size: 20px; margin: 0 0 10px 0; }
  h2 { font-size: 16px; margin: 16px 0 8px 0; }
  .toolbar { display: flex; gap: 12px; align-items: center; margin: 12px 0 16px 0; }
  button { padding: 8px 12px; border-radius: 8px; border: 1px solid #bbb; background: #f6f6f6; cursor: pointer; }
  button:hover { background: #eee; }
  table { border-collapse: collapse; width: 100%; }
  thead th { position: sticky; top: 0; background: #fafafa; z-index: 1; }
  th, td { border: 1px solid #ddd; padding: 8px; vertical-align: top; }
  th { text-align: left; font-weight: 600; }
  td input[type="number"] { width: 120px; }
  td select { width: 160px; }
  .note { color: #555; font-size: 12px; }
  .tag { padding: 2px 8px; border-radius: 999px; font-size: 12px; display: inline-block; }
  .red { background: #FDE2E1; }
  .yellow { background: #FFF2CC; }
  .green { background: #E2F0D9; }
  tfoot td { font-weight: 600; }
  .summary-box { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
  .card { border: 1px solid #ddd; border-radius: 10px; padding: 12px; }
  .amount { font-size: 18px; font-weight: 700; }
  .muted { color: #666; font-size: 12px; }
</style>
</head>
<body>
  <h1>VE Prioritization (Interactive)</h1>
  <div class="note">Edit cost savings, set a priority for each item, and the tool will auto-label and summarize totals. Use “Export CSV” to download your work.</div>

  <div class="toolbar">
    <button id="exportBtn">Export CSV</button>
  </div>

  <h2>Summary</h2>
  <div class="summary-box">
    <div class="card red">
      <div><strong>High Priority</strong> <span class="muted">(Must Keep)</span></div>
      <div>Items: <span id="highCount">8</span></div>
      <div>Total Savings: <span class="amount" id="highTotal">$0</span></div>
    </div>
    <div class="card yellow">
      <div><strong>Medium Flex</strong> <span class="muted">(Consider)</span></div>
      <div>Items: <span id="medCount">11</span></div>
      <div>Total Savings: <span class="amount" id="medTotal">$0</span></div>
    </div>
    <div class="card green">
      <div><strong>Low Flex</strong> <span class="muted">(OK to Change)</span></div>
      <div>Items: <span id="lowCount">9</span></div>
      <div>Total Savings: <span class="amount" id="lowTotal">$0</span></div>
    </div>
  </div>

  <h2>VE Items</h2>
  <table id="veTable">
    <thead>
      <tr>
        <th style="width:32%;">VE Item</th>
        <th style="width:12%;">Category</th>
        <th style="width:12%;">Cost Savings ($)</th>
        <th style="width:15%;">Priority</th>
        <th style="width:14%;">Priority Label (Auto)</th>
        <th style="width:15%;">Final Decision</th>
        <th>Comments / Rationale</th>
      </tr>
    </thead>
    <tbody><tr class="red"><td>Include domestic sprinkler system for 3 cottages</td><td>General</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Must Keep</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="yellow"><td>Confirm flash &amp; batt spray foam layer at roof decks / balconies</td><td>A-001</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Consider</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="yellow"><td>Remove radiant heat slab from Unit A; add NuHeat mat (bath)</td><td>A-001</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Consider</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="yellow"><td>Remove radiant heat slab from Unit B; add NuHeat mat (powder room)</td><td>A-001</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Consider</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="red"><td>All solid interior door heights to 6'-8"</td><td>A-002</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Must Keep</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="red"><td>Remove glass shower doors A115, B210, C110</td><td>A-002</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Must Keep</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="yellow"><td>Replace Hafele sliding door hardware with Johnson hardware</td><td>A-002</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Consider</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="red"><td>Replace multislide units (A204x &amp; B205x) w/ 3-panel patio slider</td><td>A-003</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Must Keep</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="red"><td>Or: Substitute Milgard vinyl windows for window package</td><td>A-003</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Must Keep</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="yellow"><td>Sub polished concrete slab with grind &amp; seal finish</td><td>A-004</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Consider</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="green"><td>Replace Nemo tile with Dal Keystone 1x1</td><td>A-004</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>OK to Change</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="green"><td>Replace PV-3 membrane with Tufdek / Miraflex</td><td>A-004</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>OK to Change</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="green"><td>Replace RF-1 roofing with standing seam metal roof</td><td>A-004</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>OK to Change</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="green"><td>Replace SD-1 siding with corrugated metal (22ga)</td><td>A-004</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>OK to Change</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="yellow"><td>OR replace SD-1 siding with HardieShingle</td><td>A-004</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Consider</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="yellow"><td>OR replace SD-1 siding with HardiePlank</td><td>A-004</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Consider</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="yellow"><td>Replace wood flooring with engineered oak (Kentwood)</td><td>A-004</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Consider</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="yellow"><td>Replace recessed cans with single surface-mount ceiling fixtures</td><td>A-004</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Consider</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="green"><td>Remove shed structure (keep foundation/footing)</td><td>A-101</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>OK to Change</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="green"><td>Unit A: Replace closet casework with pole + shelf</td><td>A-110</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>OK to Change</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="green"><td>Unit A: Remove built-in desk</td><td>A-110</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>OK to Change</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="green"><td>Unit A: Replace pantry counter/casework with shelf system</td><td>A-110</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>OK to Change</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="yellow"><td>Unit B: Replace P. bedroom casework with pole + shelf + bypass doors</td><td>A-111</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Consider</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="red"><td>Replace balcony guard rails with 3' parapet walls (Units A &amp; B)</td><td>A-400</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Must Keep</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="green"><td>Replace metal fence posts with wood posts on metal brackets</td><td>A-500D</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>OK to Change</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="yellow"><td>Replace flush metal/wood base trims w/ surface-applied base</td><td>A-530D</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Consider</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="red"><td>Replace Unit A stair guard w/ solid parapet wall</td><td>A-550D</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Must Keep</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr><tr class="red"><td>Replace Unit C stair guard w/ solid parapet wall</td><td>A-550D</td><td><input type="number" min="0" step="100" placeholder="0"></td><td><select><option value=""></option><option value="High Priority">High Priority</option><option value="Medium Flex">Medium Flex</option><option value="Low Flex">Low Flex</option></select></td><td>Must Keep</td><td><select><option value=""></option><option value="Keep">Keep</option><option value="Accept">Accept</option><option value="Need More Info">Need More Info</option></select></td><td><textarea rows="1" style="width: 100%;"></textarea></td></tr></tbody>
  </table>

<script>
const DATA = [
  ["Include domestic sprinkler system for 3 cottages", "General"],
  ["Confirm flash & batt spray foam layer at roof decks / balconies", "A-001"],
  ["Remove radiant heat slab from Unit A; add NuHeat mat (bath)", "A-001"],
  ["Remove radiant heat slab from Unit B; add NuHeat mat (powder room)", "A-001"],
  ["All solid interior door heights to 6'-8\"", "A-002"],
  ["Remove glass shower doors A115, B210, C110", "A-002"],
  ["Replace Hafele sliding door hardware with Johnson hardware", "A-002"],
  ["Replace multislide units (A204x & B205x) w/ 3-panel patio slider", "A-003"],
  ["Or: Substitute Milgard vinyl windows for window package", "A-003"],
  ["Sub polished concrete slab with grind & seal finish", "A-004"],
  ["Replace Nemo tile with Dal Keystone 1x1", "A-004"],
  ["Replace PV-3 membrane with Tufdek / Miraflex", "A-004"],
  ["Replace RF-1 roofing with standing seam metal roof", "A-004"],
  ["Replace SD-1 siding with corrugated metal (22ga)", "A-004"],
  ["OR replace SD-1 siding with HardieShingle", "A-004"],
  ["OR replace SD-1 siding with HardiePlank", "A-004"],
  ["Replace wood flooring with engineered oak (Kentwood)", "A-004"],
  ["Replace recessed cans with single surface-mount ceiling fixtures", "A-004"],
  ["Remove shed structure (keep foundation/footing)", "A-101"],
  ["Unit A: Replace closet casework with pole + shelf", "A-110"],
  ["Unit A: Remove built-in desk", "A-110"],
  ["Unit A: Replace pantry counter/casework with shelf system", "A-110"],
  ["Unit B: Replace P. bedroom casework with pole + shelf + bypass doors", "A-111"],
  ["Replace balcony guard rails with 3' parapet walls (Units A & B)", "A-400"],
  ["Replace metal fence posts with wood posts on metal brackets", "A-500D"],
  ["Replace flush metal/wood base trims w/ surface-applied base", "A-530D"],
  ["Replace Unit A stair guard w/ solid parapet wall", "A-550D"],
  ["Replace Unit C stair guard w/ solid parapet wall", "A-550D"]
];

const PRIORITIES = ["", "High Priority", "Medium Flex", "Low Flex"];
const LABELS = {
  "High Priority": "Must Keep",
  "Medium Flex": "Consider",
  "Low Flex": "OK to Change",
  "": ""
};

function fmtCurrency(n) {
  if (!isFinite(n)) return "$0";
  return n.toLocaleString(undefined, { style: "currency", currency: "USD", maximumFractionDigits: 0 });
}

function buildTable() {
  const tbody = document.querySelector("#veTable tbody");
  DATA.forEach(([item, cat]) => {
    const tr = document.createElement("tr");

    // VE Item
    const tdItem = document.createElement("td");
    tdItem.textContent = item;
    tr.appendChild(tdItem);

    // Category
    const tdCat = document.createElement("td");
    tdCat.textContent = cat;
    tr.appendChild(tdCat);

    // Cost Savings
    const tdCost = document.createElement("td");
    const inp = document.createElement("input");
    inp.type = "number";
    inp.min = "0";
    inp.step = "100";
    inp.placeholder = "0";
    inp.addEventListener("input", updateSummary);
    tdCost.appendChild(inp);
    tr.appendChild(tdCost);

    // Priority (dropdown)
    const tdPr = document.createElement("td");
    const sel = document.createElement("select");
    PRIORITIES.forEach(p => {
      const opt = document.createElement("option");
      opt.value = p;
      opt.textContent = p;
      sel.appendChild(opt);
    });
    sel.addEventListener("change", () => {
      // update label
      tdLabel.textContent = LABELS[sel.value] || "";
      // update row tint
      tr.classList.remove("red", "yellow", "green");
      if (sel.value === "High Priority") tr.classList.add("red");
      else if (sel.value === "Medium Flex") tr.classList.add("yellow");
      else if (sel.value === "Low Flex") tr.classList.add("green");
      updateSummary();
    });
    tdPr.appendChild(sel);
    tr.appendChild(tdPr);

    // Priority Label (Auto)
    const tdLabel = document.createElement("td");
    tdLabel.textContent = "";
    tr.appendChild(tdLabel);

    // Final Decision
    const tdFinal = document.createElement("td");
    const finalSel = document.createElement("select");
    ["", "Keep", "Accept", "Need More Info"].forEach(v => {
      const o = document.createElement("option");
      o.value = v; o.textContent = v;
      finalSel.appendChild(o);
    });
    tdFinal.appendChild(finalSel);
    tr.appendChild(tdFinal);

    // Comments
    const tdComments = document.createElement("td");
    const ta = document.createElement("textarea");
    ta.rows = 1; ta.style.width = "100%";
    tdComments.appendChild(ta);
    tr.appendChild(tdComments);

    tbody.appendChild(tr);
  });
}

function updateSummary() {
  const rows = Array.from(document.querySelectorAll("#veTable tbody tr"));
  let highCount = 0, medCount = 0, lowCount = 0;
  let highTotal = 0, medTotal = 0, lowTotal = 0;

  rows.forEach(tr => {
    const costInput = tr.querySelector('input[type="number"]');
    const prSel = tr.querySelector('select');
    const val = parseFloat(costInput.value || "0");

    if (prSel.value === "High Priority") { highCount++; highTotal += val; }
    else if (prSel.value === "Medium Flex") { medCount++; medTotal += val; }
    else if (prSel.value === "Low Flex") { lowCount++; lowTotal += val; }
  });

  document.getElementById("highCount").textContent = highCount;
  document.getElementById("medCount").textContent = medCount;
  document.getElementById("lowCount").textContent = lowCount;
  document.getElementById("highTotal").textContent = fmtCurrency(highTotal);
  document.getElementById("medTotal").textContent = fmtCurrency(medTotal);
  document.getElementById("lowTotal").textContent = fmtCurrency(lowTotal);
}

function exportCSV() {
  const rows = [["VE Item","Category","Cost Savings ($)","Priority","Priority Label (Auto)","Final Decision","Comments"]];
  document.querySelectorAll("#veTable tbody tr").forEach(tr => {
    const tds = tr.querySelectorAll("td");
    const item = tds[0].textContent.trim();
    const cat  = tds[1].textContent.trim();
    const cost = tds[2].querySelector("input").value || "0";
    const pr   = tds[3].querySelector("select").value || "";
    const label= tds[4].textContent.trim();
    const final= tds[5].querySelector("select").value || "";
    const comm = tds[6].querySelector("textarea").value || "";
    rows.push([item, cat, cost, pr, label, final, comm]);
  });
  const csv = rows.map(r => r.map(v => `"${(v+"").replaceAll('"','""')}"`).join(",")).join("\n");
  const blob = new Blob([csv], {type: "text/csv;charset=utf-8"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "VE_Prioritization.csv";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

document.getElementById("exportBtn").addEventListener("click", exportCSV);

buildTable();
updateSummary();
</script>


</body></html>